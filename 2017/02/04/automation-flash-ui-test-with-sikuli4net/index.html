<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>透過 SIKULI4NET 對 FLASH UI 進行自動化測試 &vert; OUCH1978 @ GITHUB</title>
<meta name="description" content="你還在使用錄製滑鼠和鍵盤動作的方式來測試 Flash UI 嗎? 只要視窗位置跑掉測試就會失敗嗎? 有這種困擾的話，不妨試試更好玩的 Sikuli4Net 吧!!">
<meta name="keywords" content="C#, Sikuli4Net, Visual Studio, Coded UI Test">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://ouch1978.github.io/images/feature-01.jpg">

<meta name="twitter:title" content="透過 Sikuli4Net 對 Flash UI 進行自動化測試">
<meta name="twitter:description" content="你還在使用錄製滑鼠和鍵盤動作的方式來測試 Flash UI 嗎? 只要視窗位置跑掉測試就會失敗嗎? 有這種困擾的話，不妨試試更好玩的 Sikuli4Net 吧!!">
<meta name="twitter:creator" content="@Ouch1978">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="透過 Sikuli4Net 對 Flash UI 進行自動化測試">
<meta property="og:description" content="你還在使用錄製滑鼠和鍵盤動作的方式來測試 Flash UI 嗎? 只要視窗位置跑掉測試就會失敗嗎? 有這種困擾的話，不妨試試更好玩的 Sikuli4Net 吧!!">
<meta property="og:url" content="http://ouch1978.github.io/2017/02/04/automation-flash-ui-test-with-sikuli4net/">
<meta property="og:site_name" content="Ouch1978 @ Github">
<meta property="og:image" content="http://ouch1978.github.io/images/feature-01.jpg">





<link rel="canonical" href="http://ouch1978.github.io/2017/02/04/automation-flash-ui-test-with-sikuli4net/">
<link href="http://ouch1978.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Ouch1978 @ Github Feed">
<link rel="author" href="https://plus.google.com/u/0/110363696453312268733?rel=author">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <link href='http://fonts.googleapis.com/earlyaccess/notosanstc.css' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Montserrat:400,700|Open+Sans:400,600,300,800,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="http://ouch1978.github.io/assets/css/vendor/font-awesome.min.css">
    <link rel="stylesheet" href="http://ouch1978.github.io/assets/css/vendor/normalize.css">
    <link rel="stylesheet" href="http://ouch1978.github.io/assets/css/vendor/nprogress.css">
    <link rel="stylesheet" href="http://ouch1978.github.io/assets/css/vendor/foundation.min.css">
    <link rel="stylesheet" href="http://ouch1978.github.io/assets/css/style.css">
    <link rel="stylesheet" href="http://ouch1978.github.io/assets/css/post.css">
    <link rel="stylesheet" href="http://ouch1978.github.io/assets/css/syntax.css">




<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://ouch1978.github.io/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://ouch1978.github.io/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://ouch1978.github.io/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://ouch1978.github.io/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://ouch1978.github.io/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://ouch1978.github.io/images/apple-touch-icon-144x144-precomposed.png">

<style type="text/css">@media only screen and (min-width:43.75em){.notepad-post-content div>p:first-child:first-letter{float:left;font-size:4.688rem;line-height:4.375rem;padding-top:.25rem;padding-right:.5rem;padding-left:.188rem;font-weight:bold;color: #e51843;}}</style>
</head>
<body class="post-template" itemscope itemtype="http://schema.org/WebPage">

        <main id="notepad-post-container" class="notepad-post-container intro-effect-sliced" role="main">
            <header class="notepad-post-header">
                <div class="bg-img"></div>

                <div class="notepad-post-menu-header">

                    <a class="notepad-blog-logo" href="http://ouch1978.github.io">
                        <img src="http://ouch1978.github.io/images/logo.png" alt="Blog Logo" />
                    </a>

                <div class="notepad-blog-menu">
    <div class="notepad-mobile-menu show-for-small">
        <a href="#"><i class="fa fa-bars"></i></a>
    </div>
    <ul class="notepad-menu">
        <li class="notepad-mobile-close-btn show-for-small text-right">
            <a href="#"><i class="fa fa-times"></i></a>
        </li>

            <li>
                    <a href="http://ouch1978.github.io/">首頁</a>
                 </li>

            <li>
                    <a href="http://ouch1978.github.io/featured">精選文章</a>
                 </li>

            <li>
                    <a href="http://ouch1978.github.io/categories">文章分類</a>
                 </li>

           <li><a href="http://ouch1978.github.io/feed.xml" title="Atom/RSS feed"><i class="icon-rss"></i>RSS</a></li>
    </ul>

</div>
            </div>

            <div class="notepad-post-title bg-check">
                <h1>透過 Sikuli4Net 對 Flash UI 進行自動化測試</h1>
                <p>by <strong>Ouch Liu (劉耀群)</strong> &#8212; on <a href="http://ouch1978.github.io/tags/index.html#C#" data-toggle="tooltip" title="Posts tagged with C#" rel="tag">C#</a>&nbsp;&comma;&nbsp;<a href="http://ouch1978.github.io/tags/index.html#Sikuli4Net" data-toggle="tooltip" title="Posts tagged with Sikuli4Net" rel="tag">Sikuli4Net</a>&nbsp;&comma;&nbsp;<a href="http://ouch1978.github.io/tags/index.html#Visual Studio" data-toggle="tooltip" title="Posts tagged with Visual Studio" rel="tag">Visual Studio</a>&nbsp;&comma;&nbsp;<a href="http://ouch1978.github.io/tags/index.html#Coded UI Test" data-toggle="tooltip" title="Posts tagged with Coded UI Test" rel="tag">Coded UI Test</a> <strong><time datetime="2017-02-04T23:50:00+08:00">04 Feb 2017</time></strong></p>
            </div>
            <div class="bg-img"></div>
        </header>
        <button class="trigger bg-check" data-info="Read more"><span>Trigger</span></button>
        <img src="http://ouch1978.github.io/images/feature-01.jpg" alt="cover-image" />

        <article class="notepad-post-content post">
            <div><h2 id="section">前言</h2>

<p>在導入 CI/CD 的時候，能將測試自動化是很重要的一個環節。 然而，除了「<code>工程師生出來就應該要會</code>」的 Unit Test 之外， UI 的自動化測試也很重要。</p>

<p>基於大部份的工具都難以辨識以 Flash / Flex 編寫的 UI 裡面的元件的關係，因此大多數有需要針對 Flash UI 進行測試的需求時，最常使用的方式就是直接錄製滑鼠和鍵盤的動作。 這個方式固然可行，但是一來程式碼相對的複雜(可能得引用到 Windows API)、入門的門檻相對提高；二來，一旦 Flash 或是視窗的位置不小心跑掉，整個測試就會失敗了。</p>

<p>針對上述的兩個問題，讓我好奇是不是還有更好的方式可以讓我們以更簡單、有效率，而且更準確的方式來針對 Flash UI 進行自動化測試，而且最好能和 Selenium 混搭。 最後，總算讓我找到另一條出路啦，也就是今天要介紹的主角 – <a href="https://www.nuget.org/packages/Sikuli4Net" title="Sikuli4Net - Call Sikuli from your .NET project">Sikuli4Net</a>。</p>

<p>其實 Sikuli 本來是一個以 Java 為基礎而開發出來的工具，從 2009 年開始了這個專案，在 2012 年正式完成。 主要的開發者 <a href="http://blog.vgod.tw/2010/01/30/sikuli/" title="vgod">vgod</a> 也是台灣人喔!!(台灣之光!! 灑花~~~~ 關於 Sikuli 的詳細發展史，請參閱<a href="https://en.wikipedia.org/wiki/Sikuli" title="Sikuli - Wiki">維基百科</a>)</p>

<p>Sikuli 主要的功能和特色是：讓我們以擷圖的方式，取代我們的眼睛，再透過 Sikuli 幫我們進行比對，找到目標控制項，並且和它進行互動。</p>

<p>不過，前面已經提到了， Sikuli 是以 Java 為基礎開發的，所以沒辦法直接透過 .Net / C# 呼叫，得要透過 Wrapper 多包一層才能給 .Net 使用。 而這個包好可以給 .Net 使用的版本， 在 Nuget 上也有兩三種，不過最後我還是選擇了 Sikuli4Net。</p>

<h2 id="section-1">使用方式</h2>

<p>介紹了那麼多，光說不練是不夠的，接下來我們就來透過一個實例，見證透過 Sikuli4Nnet 為我們帶來的奇蹟吧!!</p>

<p>在我們開始之前，得先確認你的電腦裡面得有安裝 Java Runtime Environment 6 以上的版本(這個應該每個人都有吧?)，否則會出現系統找不到檔案的錯誤。</p>

<p>第一步當然就開啟地表最強的開發工具 - Visual Studio 建立我們的測試專案囉。</p>

<p><a href="/images/blog-images/2017-02-04-automation-flash-ui-test-with-sikuli4net/01-create-coded-ui-test-project.png" title="建立 Coded UI Test 專案"><img src="/images/blog-images/2017-02-04-automation-flash-ui-test-with-sikuli4net/01-create-coded-ui-test-project.png" alt="建立 Coded UI Test 專案" title="建立 Coded UI Test 專案" /></a>    </p>

<p>接著， Visual Studio 會貼心的問我們要用什麼方式建立程式碼，這邊我直接按下 Cancel 鈕。</p>

<p><a href="/images/blog-images/2017-02-04-automation-flash-ui-test-with-sikuli4net/02-click-cancel-to-bypass-ui-recording.png" title="不使用錄製的方式建立程式碼"><img src="/images/blog-images/2017-02-04-automation-flash-ui-test-with-sikuli4net/02-click-cancel-to-bypass-ui-recording.png" alt="不使用錄製的方式建立程式碼" title="不使用錄製的方式建立程式碼" /></a>    </p>

<p>再來，透過 Nuget 安裝以下的元件庫吧。</p>

<ul>
  <li>
    <p>Selenium.WebDriver</p>
  </li>
  <li>
    <p>Selenium.Support</p>
  </li>
  <li>
    <p>Selenium.WebDriver.ChromeDriver</p>
  </li>
  <li>
    <p>Sikuli4Net</p>
  </li>
</ul>

<p>安裝完需要使用的元件庫之後，就可以找一個 Flash 小遊戲來試刀了。</p>

<p>為了完成這個範例，我在網路上隨便找了一個 <a href="https://en.wikipedia.org/wiki/Sikuli" title="Flash 算命小遊戲">Flash 算命小遊戲</a>來作為我測試的目標。</p>

<p>為了證明 Sikuli4Net 可以和 Selenium 混搭使用，所以這裡就簡單的透過 Selenium 的 ChromeDriver 來幫我們用 Chrome 開啟目標網頁。</p>

<p>準備工作完成之後，就可以開始準備使用擷圖工具來把目標控制項的部份擷取下來並且加入到專案裡了。</p>

<p>以這次的範例來說，我會先在專案中建立一個名為 Images 的資料夾，再分別把 Flash 中需要點擊或是輸入文字的控制項分別擷圖存檔，並且放進 Images 資料夾中。</p>

<p>這邊有很重要的一點 – <code>圖檔的 Copy to Output Directory 屬性記得要設為 Copy always</code> ，不然在執行的時候會出錯喔。</p>

<p><a href="/images/blog-images/2017-02-04-automation-flash-ui-test-with-sikuli4net/03-prepare-screenshot-for-components.png" title="Copy to Output Directory 屬性記得要設為 Copy always"><img src="/images/blog-images/2017-02-04-automation-flash-ui-test-with-sikuli4net/03-prepare-screenshot-for-components.png" alt="Copy to Output Directory 屬性記得要設為 Copy always" title="Copy to Output Directory 屬性記得要設為 Copy always" /></a>    </p>

<p>這些動作都完成了之後，再來就是透過 Sikuli4Net 提供的 API 來撰寫我們的測試啦!!</p>

<p>完整的程式碼如下：</p>

<blockquote class="filename">
  <p>CodedUITest1.cs</p>
</blockquote>

<figure class="highlight"><pre><code class="language-c#" data-lang="c#"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100</pre></td><td class="code"><pre><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.VisualStudio.TestTools.UITesting</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.VisualStudio.TestTools.UnitTesting</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">OpenQA.Selenium</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">OpenQA.Selenium.Chrome</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Sikuli4Net.sikuli_REST</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Sikuli4Net.sikuli_UTIL</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">SikuliCodedUITestProject</span>
<span class="p">{</span>
    <span class="p">[</span><span class="n">CodedUITest</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">CodedUITest1</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="n">IWebDriver</span> <span class="n">_driver</span><span class="p">;</span>

        <span class="n">APILauncher</span> <span class="n">_launcher</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">APILauncher</span><span class="p">(</span> <span class="k">true</span> <span class="p">);</span>

        <span class="k">public</span> <span class="nf">CodedUITest1</span><span class="p">()</span>
        <span class="p">{</span>
        <span class="p">}</span>

        <span class="err">#</span><span class="n">region</span> <span class="n">Additional</span> <span class="n">test</span> <span class="n">attributes</span>

        <span class="c1">// You can use the following additional attributes as you write your tests:
</span>
        <span class="c1">//Use TestInitialize to run code before running each test
</span>        <span class="p">[</span><span class="nf">TestInitialize</span><span class="p">()]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">MyTestInitialize</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">_launcher</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>
            <span class="n">_driver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ChromeDriver</span><span class="p">();</span>
            <span class="n">_driver</span><span class="p">.</span><span class="nf">Manage</span><span class="p">().</span><span class="n">Window</span><span class="p">.</span><span class="nf">Maximize</span><span class="p">();</span>
            <span class="n">_driver</span><span class="p">.</span><span class="nf">Navigate</span><span class="p">().</span><span class="nf">GoToUrl</span><span class="p">(</span> <span class="s">"http://www.xingzuo360.cn/uploads/media/121030/1-1210300F426.swf"</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">//Use TestCleanup to run code after each test has run
</span>        <span class="p">[</span><span class="nf">TestCleanup</span><span class="p">()]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">MyTestCleanup</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">_driver</span><span class="p">.</span><span class="nf">Quit</span><span class="p">();</span>
            <span class="n">_launcher</span><span class="p">.</span><span class="nf">Stop</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="err">#</span><span class="n">endregion</span>


        <span class="p">[</span><span class="n">TestMethod</span><span class="p">]</span>
        <span class="p">[</span><span class="nf">DeploymentItem</span><span class="p">(</span> <span class="s">"Images\\"</span> <span class="p">,</span><span class="s">"Images\\"</span> <span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">CodedUITestMethod1</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Thread</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="m">5000</span><span class="p">);</span>

            <span class="c1">//定義目前的畫面為偵測區
</span>            <span class="n">Screen</span> <span class="n">mainPage</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Screen</span><span class="p">();</span>

            <span class="c1">//透過 Pattern 類別宣告並定義要比對的控制項擷圖
</span>            <span class="n">Pattern</span> <span class="n">goButton</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Pattern</span><span class="p">(</span> <span class="n">Path</span><span class="p">.</span><span class="nf">Combine</span><span class="p">(</span> <span class="n">AppDomain</span><span class="p">.</span><span class="n">CurrentDomain</span><span class="p">.</span><span class="n">BaseDirectory</span> <span class="p">+</span> <span class="s">@"\Images\Go.png"</span> <span class="p">)</span> <span class="p">);</span>
            <span class="n">Pattern</span> <span class="n">nameField</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Pattern</span><span class="p">(</span> <span class="n">Path</span><span class="p">.</span><span class="nf">Combine</span><span class="p">(</span> <span class="n">AppDomain</span><span class="p">.</span><span class="n">CurrentDomain</span><span class="p">.</span><span class="n">BaseDirectory</span> <span class="p">+</span> <span class="s">@"\Images\Name.png"</span> <span class="p">)</span> <span class="p">);</span>
            <span class="n">Pattern</span> <span class="n">birthdayField</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Pattern</span><span class="p">(</span> <span class="n">Path</span><span class="p">.</span><span class="nf">Combine</span><span class="p">(</span> <span class="n">AppDomain</span><span class="p">.</span><span class="n">CurrentDomain</span><span class="p">.</span><span class="n">BaseDirectory</span> <span class="p">+</span> <span class="s">@"\Images\Birthday.png"</span> <span class="p">)</span> <span class="p">);</span>
            <span class="n">Pattern</span> <span class="n">gender</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Pattern</span><span class="p">(</span> <span class="n">Path</span><span class="p">.</span><span class="nf">Combine</span><span class="p">(</span> <span class="n">AppDomain</span><span class="p">.</span><span class="n">CurrentDomain</span><span class="p">.</span><span class="n">BaseDirectory</span> <span class="p">+</span> <span class="s">@"\Images\Gender.png"</span> <span class="p">)</span> <span class="p">);</span>
            <span class="n">Pattern</span> <span class="n">bloodType</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Pattern</span><span class="p">(</span> <span class="n">Path</span><span class="p">.</span><span class="nf">Combine</span><span class="p">(</span> <span class="n">AppDomain</span><span class="p">.</span><span class="n">CurrentDomain</span><span class="p">.</span><span class="n">BaseDirectory</span> <span class="p">+</span> <span class="s">@"\Images\BloodType.png"</span> <span class="p">)</span> <span class="p">);</span>
            <span class="n">Pattern</span> <span class="n">placeField</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Pattern</span><span class="p">(</span> <span class="n">Path</span><span class="p">.</span><span class="nf">Combine</span><span class="p">(</span> <span class="n">AppDomain</span><span class="p">.</span><span class="n">CurrentDomain</span><span class="p">.</span><span class="n">BaseDirectory</span> <span class="p">+</span> <span class="s">@"\Images\PlaceGrownUp.png"</span> <span class="p">)</span> <span class="p">);</span>
            <span class="n">Pattern</span> <span class="n">okButton</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Pattern</span><span class="p">(</span> <span class="n">Path</span><span class="p">.</span><span class="nf">Combine</span><span class="p">(</span> <span class="n">AppDomain</span><span class="p">.</span><span class="n">CurrentDomain</span><span class="p">.</span><span class="n">BaseDirectory</span> <span class="p">+</span> <span class="s">@"\Images\OkButton.png"</span> <span class="p">)</span> <span class="p">);</span>
            <span class="n">Pattern</span> <span class="n">result</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Pattern</span><span class="p">(</span> <span class="n">Path</span><span class="p">.</span><span class="nf">Combine</span><span class="p">(</span> <span class="n">AppDomain</span><span class="p">.</span><span class="n">CurrentDomain</span><span class="p">.</span><span class="n">BaseDirectory</span> <span class="p">+</span> <span class="s">@"\Images\Result.png"</span> <span class="p">)</span> <span class="p">);</span>

            <span class="c1">//等待 go 按鈕出現
</span>            <span class="n">mainPage</span><span class="p">.</span><span class="nf">Wait</span><span class="p">(</span> <span class="n">goButton</span> <span class="p">);</span>

            <span class="c1">//對 go 按鈕按下滑鼠左鍵
</span>            <span class="n">mainPage</span><span class="p">.</span><span class="nf">Click</span><span class="p">(</span><span class="n">goButton</span><span class="p">);</span>

            <span class="n">Thread</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span> <span class="m">3000</span> <span class="p">);</span>

            <span class="c1">//在姓名欄位輸入文字
</span>            <span class="n">mainPage</span><span class="p">.</span><span class="nf">Type</span><span class="p">(</span> <span class="n">nameField</span> <span class="p">,</span> <span class="s">"Ouch"</span> <span class="p">);</span>

            <span class="c1">//在生日欄位輸入文字
</span>            <span class="n">mainPage</span><span class="p">.</span><span class="nf">Type</span><span class="p">(</span> <span class="n">birthdayField</span><span class="p">,</span> <span class="s">"19781128"</span> <span class="p">);</span>

            <span class="c1">//點選男性
</span>            <span class="n">mainPage</span><span class="p">.</span><span class="nf">Click</span><span class="p">(</span> <span class="n">gender</span> <span class="p">);</span>

            <span class="c1">//點選 B 型
</span>            <span class="n">mainPage</span><span class="p">.</span><span class="nf">Click</span><span class="p">(</span> <span class="n">bloodType</span> <span class="p">);</span>

            <span class="c1">//在成長地點欄位輸入文字
</span>            <span class="n">mainPage</span><span class="p">.</span><span class="nf">Type</span><span class="p">(</span> <span class="n">placeField</span> <span class="p">,</span> <span class="s">"Taipei"</span> <span class="p">);</span>

            <span class="c1">//按下 Ok 按鈕
</span>            <span class="n">mainPage</span><span class="p">.</span><span class="nf">Click</span><span class="p">(</span> <span class="n">okButton</span> <span class="p">);</span>

            <span class="n">Thread</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span> <span class="m">8000</span> <span class="p">);</span>

            <span class="c1">//以結果是否出現作為判斷測試成功的條件
</span>            <span class="n">Assert</span><span class="p">.</span><span class="nf">IsTrue</span><span class="p">(</span><span class="n">mainPage</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span><span class="n">result</span><span class="p">));</span>
       <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>專案原始檔連結在此，歡迎自行取用。</p>

<p><a href="https://github.com/Ouch1978/Sikuli4NetCodedUITestSample/"><img src="/images/blog-images/source-code-link.png" alt="Sikuli4NetCodedUITestSample" /></a></p>

<h2 id="section-2">注意事項 / 小心得</h2>

<p>基本上，透過 Sikuli4Net 應該可以完成我們通常會對 Flash UI 進行的大部份操作。 不過如果想要針對長相一樣的多個控制項進行重複操作的話，這個部份我就還沒摸出來了。</p>

<p>另外，建議擷圖的部份儘量擷取比控制項還要大一點點的範圍，以提升比對準確度，如果 Flash 裡面有動畫或是需要等待它載入的話，也可以適當的透過 Thread.Sleep() 方法延緩測式的時間。</p>

<p>以上，如果你手邊也有古早的 Flash UI 需要測試的話，不妨也試看看 Sikuli4Net 吧~</p>

<p>當然，如果你有更好用、更簡便的方法或工具，也歡迎不吝分享喔!!~</p>

            </div>
        </article>

        <div class="cf"></div>
        <div class="row text-center">
            <section class="notepad-post-share">
                <a class="twitter-icon" href="https://twitter.com/intent/tweet?text=&quot;透過 Sikuli4Net 對 Flash UI 進行自動化測試&quot;%20http://ouch1978.github.io/2017/02/04/automation-flash-ui-test-with-sikuli4net/%20via%20&#64;Ouch1978"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Share on Twitter">
                    <i class="fa fa-twitter"></i>
                </a>
                <a class="facebook-icon" href="https://www.facebook.com/sharer/sharer.php?u=http://ouch1978.github.io/2017/02/04/automation-flash-ui-test-with-sikuli4net/"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook">
                    <i class="fa fa-facebook"></i>
                </a>
                <a class="google-icon" href="https://plus.google.com/share?url=http://ouch1978.github.io/2017/02/04/automation-flash-ui-test-with-sikuli4net/"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title="Share on Google+">
                    <i class="fa fa-google-plus"></i>
                </a>
            </section>
        </div>

        <div class="cf"></div>

        <div class="PageNavigation">
          
            <a class="prev" href="/2017/02/03/html-to-md-exporter/">&laquo; 部落格備份/搬家小工具 - Html to MD Exporter</a>
          
          
            <a class="next" href="/2017/03/25/material-design-xaml-toolkit/">透過 MaterialDesignXamlToolkit 讓你的 WPF 應用程式潮又有料 &raquo;</a>
          
        </div>

            <div class="notepad-author-info">
                <div class="row">
                    <section class="notepad-post-author small-12 columns">

                            <img src="http://ouch1978.github.io/images/Ouch.jpg" class="notepad-post-author-avatar" alt="Ouch Liu (劉耀群)'s photo">

                            <span class="author-label">作者</span>
                            <h1>Ouch Liu (劉耀群)</h1>

                            <p>略懂設計的軟體工程師 / 略懂程式的設計師</p>

                    </section>
                </div>
            </div>


        <div class="cf"></div>
        
        <section class="notepad-disqus row">
    <div class="small-12 columns">
        <h1 class="notepad-comments-header">Comments</h1>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'Ouch1978'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
</section>

        <div class="cf"></div>

    <footer class="notepad-site-footer">
    <div class="copyright">
         <section>All content copyright <a href="http://ouch1978.github.io/about">Ouch Liu (劉耀群)</a> &copy; 2017 &bull; All rights reserved.</section>
         <section>Proudly published with <a class="icon-ghost" href="https://jekyllrb.com/">Jekyll</a></section>
    </div>
    <div class="social-icons">
        
			<a href="https://linkedin.com/in/Ouch1978">
				  <span class="fa-stack fa-lg">
					<i class="fa fa-circle fa-stack-2x fa-inverse"></i>
					<i class="fa fa-linkedin fa-stack-1x"></i>
				</span>
			</a>
		
		
        <a href="http://facebook.com/Ouch1978">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-facebook fa-stack-1x"></i>
            </span>
        </a>
        
        
        <a href="http://twitter.com/Ouch1978">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-twitter fa-stack-1x"></i>
            </span>
        </a>
        
        
        <a href="https://plus.google.com/u/0/110363696453312268733">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-google-plus fa-stack-1x"></i>
            </span>
        </a>
        
        
        <a href="http://github.com/Ouch1978">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-github fa-stack-1x"></i>
            </span>
        </a>
        
        
		</div>
    
    <div class="cf"></div>
</footer>
</main>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="http://ouch1978.github.io/assets/js/vendor/jquery-1.11.1.min.js"><\/script>')</script>
    <script src="http://ouch1978.github.io/assets/js/vendor/modernizr.js"></script>
    <script src="http://ouch1978.github.io/assets/js/foundation.min.js"></script>
    <script src="http://ouch1978.github.io/assets/js/vendor/background-check.js"></script>
    <script src="http://ouch1978.github.io/assets/js/vendor/post-header-animations.js"></script>
    <script src="http://ouch1978.github.io/assets/js/notepad.js"></script>
    <script src="http://ouch1978.github.io/assets/js/scripts.min.js"></script>
    <script src="http://ouch1978.github.io/assets/js/vendor/nprogress.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/3.0.0/pangu.js"></script>

    <script>
      $(document).foundation();
      pangu.spacingPage();
    </script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-20523508-2', 'auto');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');

</script>

<script>NProgress.start();var interval=setInterval(function(){NProgress.inc()},1000);jQuery(window).load(function(){clearInterval(interval);NProgress.done()});jQuery(window).unload(function(){NProgress.start()});</script>

</body>
</html>
